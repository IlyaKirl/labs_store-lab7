package ru.ystu.labs_store.service.user;import org.springframework.security.core.userdetails.UserDetails;import org.springframework.security.core.userdetails.UserDetailsService;import org.springframework.security.core.userdetails.UsernameNotFoundException;import org.springframework.stereotype.Service;import ru.ystu.labs_store.model.User;import ru.ystu.labs_store.repository.UserRepository;@Servicepublic class UserService implements UserDetailsService {	private final UserRepository userRepository;	public UserService(UserRepository userRepository) {		this.userRepository = userRepository;	}	@Override	public UserDetails loadUserByUsername(String login) throws UsernameNotFoundException {		User user = userRepository.findUserByLogin(login);		if (user == null) {			throw new UsernameNotFoundException("Unknown user: " + login);		} else {			boolean isAdmin = user.getLogin().equals("admin");			String role;			if (isAdmin) {				role = "admin";			} else {				role = "user";			}			return org.springframework.security.core.userdetails.User.builder()					.username(user.getLogin())					.password(user.getPassword())					.roles(role)					.build();		}	}}